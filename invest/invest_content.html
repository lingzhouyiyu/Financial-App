<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

	<head>
		<title></title>
		<meta charset="utf-8">
		<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="../common/css/fonts/font-awesome.min.css" />
		<link rel="stylesheet" href="../common/css/appcan.control.css">
		<link rel="stylesheet" href="../common/css/ui-box.css">
		<link rel="stylesheet" href="../common/css/ui-base.css">
		<link rel="stylesheet" href="../common/css/ui-color.css">
		<link rel="stylesheet" href="../common/css/appcan.icon.css">
		<link rel="stylesheet" href="../common/css/appcan.control.css">
		<link rel="stylesheet" href="css/main.css">
	</head>

	<body class="um-vp bc-bg" ontouchstart>
		<div class="ub ub-ver redeem_top topmoney">
			
			<div class="ub ub-ac top_btom top_btom04">
				<div class="ub ub-ac ub-f1 ub-fh borderwhite removeborder">
					<span class="tzbjtext"></span>
					<span class="tzbj">0.00</span>
				</div>
				<div class="ub ub-ac ub-pc ub-f1 ub-fh">
					<span class="sybjtext"></span>
					<span class="sybj">0.00</span>
				</div>
			</div>
			<div class="ub ub-ac top_btom top_btom04">
				<div class="ub ub-ac ub-f1 ub-fh borderwhite removeborder">
					<span class="dslxtext"></span>
					<span class="dslx">0.00</span>
				</div>
				<div class="ub ub-ac ub-pc ub-f1 ub-fh">
					<span class="yslxtext"></span>
					<span class="yslx">0.00</span>
				</div>
			</div>
		</div>
		<div class="ub invest_cate color96">
			<div id="stss" class="ub ub-ac ub-pc ub-f1 dbtop boder_l ub-fh top_active">
				随投随赎
			</div>
			<div id="stds" class="ub ub-ac ub-pc boder_l dbtop ub-f1 ub-fh">
				随投定赎
			</div>
			<div id="lebao" class="ub ub-ac ub-pc boder_l ub-f1 ub-fh dbtop">
				乐宝
			</div>
			<div id="lyg" class="ub ub-ac ub-pc ub-f1 ub-fh dbtop">
				0元购
			</div>
		</div>
		<div class="listtotal">

		</div>
		<!--进行中item-->
		<div class="stsstemp uhide">
			<div class="ub ub-ver redeem_item stitem">
				<div class="ub ub-ac ub-f1 top_name">
					<div class="ub umar-r ub-f1  name_left bc-text">
						<span>[</span>
						<span class="Ftype">随投随赎</span>
						<span>]</span>
						<span class="FMingC">欣欣财富</span>
					</div>
					<div class="ub  name_right">
						<div class="ub ub-ac ub-pc umar-r">
							<img src="../common/images/blueclock.png" />
						</div>
						<span class="Fstate">回款中</span>
					</div>
				</div>
				<div class="ub botm_detial">
					<div class="ub ub-ver ub-f1 ub-fh">
						<div class="ub margin6">
							<span class="color96 umar-r">投资金额 </span>
							<span class="colorglod Fmoney">100</span>
						</div>
						<div class="ub">
							<span class="color96 umar-r">年化利率</span>
							<span class="bc-text FLiX">0.00</span>
							<span>%</span>
						</div>
						<div class="ub">
							<span class="color96 umar-r">类型</span>
							<span class="bc-text Fzero">信用授信</span>
						</div>
						<div class="ub">
							<span class="color96 umar-r">剩余投资金额</span>
							<span class="bc-text Fsyje">1000</span>
						</div>
					</div>
					<div class="ub ub-ver ub-f1 ub-fh">
						<div class="ub margin6">
							<span class="color96 umar-r">投资时间 </span>
							<span class="bc-text FdownTime">2016-10-11</span>
						</div>
						<div class="ub">
							<span class="color96 umar-r">期限 </span>
							<span class="bc-text FTouZqx"></span>
							<span class="bc-text Fdaw"></span>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!--已完成item-->
		<div class="ub ub-ver redeem_item uhide">
			<div class="ub ub-ac ub-f1 top_name">
				<div class="ub umar-r ub-f1  name_left bc-text">
					<span>[</span>
					<span>随投随赎</span>
					<span>]</span>
					<span>欣欣财富</span>
				</div>
				<div class="ub  name_right">
					<div class="ub ub-ac ub-pc umar-r">
						<img src="../common/images/blueclock.png" />
					</div>
					<span>已完成</span>
				</div>
			</div>
			<div class="ub botm_detial">
				<div class="ub ub-ver ub-f1 ub-fh">
					<div class="ub margin6">
						<span class="color96 umar-r">投资金额 </span>
						<span class="colorglod">100</span>
					</div>
					<div class="ub">
						<span class="color96 umar-r">年化利率</span>
						<span class="bc-text">10.95</span>
						<span>%</span>
					</div>
				</div>
				<div class="ub ub-ver ub-f1 ub-fh">
					<div class="ub margin6">
						<span class="color96 umar-r">投资时间 </span>
						<span class="bc-text">2016-10-11</span>
					</div>
					<div class="ub">
						<span class="color96 umar-r">期限 </span>
						<span class="bc-text">10</span>
						<span class="bc-text">天</span>
					</div>
				</div>
			</div>
		</div>
		<script src="../common/js/appcan.js"></script>
		<script src="../common/js/appcan.control.js"></script>
		<script type="text/javascript" src="../common/js/yfkj.js"></script>
		<script type="text/javascript" src="../common/js/jquery.1.10.2.js"></script>
	</body>
	<script>
		var Fselect = appcan.locStorage.getVal("Fselect");
		var pageSize = 10;
		var Fstart = 0;
		var FTzselects = "jxz";
		appcan.ready(function() {
				appcan.window.subscribe('FTzselects', function(msg) {
					FTzselects = msg;
					$('.listtotal').empty();
					Fstart = 0;
					headermoney(Fselect);
					getTzList();
				});
				$(".dbtop").removeClass("top_active");
				$("#" + Fselect).addClass("top_active");
				headermoney(Fselect);
				getTzList();
				appcan.frame.setBounce([0, 1], function(type) {
					$("#pullstatus" + type).html(!type ? "开始下拉" : "开始上拖");
				}, function(type) {
					$("#pullstatus" + type).html(!type ? "下拉超过临界点,产生事件了！" : "超过临界点,产生事件了！");
				}, function(type) {
					if(type == 0) {
						$('.listtotal').empty();
						Fstart = 0;
						getTzList();
					} else if(type == 1) {
						getTzList();
					}
					setTimeout(function() {
						appcan.frame.resetBounce(type);
					}, 1000);
				})
			})
			//头部切换
		appcan.button(".dbtop", "ani-act", function(a, b) {
				$(".dbtop").removeClass("top_active");
				$(this).addClass("top_active");
				Fselect = $(this).attr("id");
				if(Fselect == "stss") {
					headermoney(Fselect);
				}
				if(Fselect == "stds") {
					headermoney(Fselect);
				}
				if(Fselect == "lyg") {
					headermoney(Fselect);
				}
				if(Fselect == "lebao") {
					$(".tzbjtext").text("");
					$(".dslxtext").text("");
					$(".yslxtext").text("");

					$(".tzbj").text("");
					$(".dslx").text("");
					$(".yslx").text("");

					$('.listtotal').empty();
					return;
				}
				$('.listtotal').empty();
				Fstart = 0;
				getTzList();
			})
			//获取我的投资列表
		function getTzList() {
			var furl = "/app/getMyTouZLiset";
			appcan.ajax({
				url: Serverurl + furl,
				type: "POST",
				dataType: "json",
				data: {
					Fuserid: Fsuper.getuserid(),
					Ftype: Fselect,
					pageSize: pageSize,
					Fstart: Fstart,
					FTzselects: FTzselects
				},
				success: function(result) {
					var rows = result.data.rows;
					console.log(rows);
					var code = result.code;
					var msg = result.msg;
					var debug = result.debug;
					var end = result.data.end;
					var length = rows.length;
					if(code < 10000) {
						if(code == 0) { //返回成功
							$(rows).each(function(i, row) {
								addstsuitem(row, end);
							});
						}
					} else {
						if(Fsuperdbg) {
							alert(result.code);
							alert(result.msg);
							alert(result.debug);
						}
					}
				}
			});

		}

		function addstsuitem(row, end) {
			var list = $(".listtotal");
			var item = $(".stsstemp").clone();
			var domitem = item.find(".stitem");
			domitem.attr("id", row.Fid);
			if(row.FType == "0") {
				domitem.find(".Ftype").text("新手标");
			}
			if(row.FType == "1") {
				domitem.find(".Ftype").text("随投随赎");
			}
			if(row.FType == "2") {
				domitem.find(".Ftype").text("随投定赎");
			}
			if(row.Fzero == "0") {
				domitem.find(".Fzero").text("信用授信");
				domitem.find(".FLiX").text(row.FLiX.toFixed(2));
			}
			if(row.Fzero == "1") {
				domitem.find(".Fzero").text("0元购");
				domitem.find(".FLiX").text(row.FLiX_prepose.toFixed(2));
			}
			if(row.Fzero == "2") {
				domitem.find(".Fzero").text("利息前置");
				domitem.find(".FLiX").text(row.FLiX_prepose.toFixed(2));
			}
			var Fmoney = Number(row.Fmoney);
			var FShmoney = Number(row.FShMoney);
			var delt = Fmoney - FShmoney;
			if(delt == 0) {
				domitem.find(".Fstate").text("已赎回");
			} else {
				domitem.find(".Fstate").text("回款中");
			}
			domitem.find(".Fsyje").text(row.Fsyje);
			domitem.find(".FMingC").text(row.FMingC);
			domitem.find(".Fmoney").text(row.Fmoney.toFixed(2));

			domitem.find(".FdownTime").text(row.FdownTime);
			if(row.FTouZlx == "0") {
				domitem.find(".FTouZqx").text("--");
				domitem.find(".Fdaw").text("天");
			} else {
				if(row.FJiXlx == "0") {
					domitem.find(".FTouZqx").text(row.FTouZqx);
					domitem.find(".Fdaw").text("天");
				} else {
					domitem.find(".FTouZqx").text(row.FTouZqx);
					domitem.find(".Fdaw").text("个月");
				}
			}
			domitem.attr("onclick", "details('" + row.FType + "','" + row.Fid + "','" + row.FMingC + "','" + row.Fzero + "')");
			list.append(domitem);
			Fstart = end;
		}

		function details(FType, Fid, FMingC, Fzero) {
			if(FType == "1" || FType == "4" || FType == "5" || FType == "6") { //随投随赎
				appcan.locStorage.setVal("Fhqmid", Fid);
				appcan.locStorage.setVal("hFMingC", FMingC);
				appcan.window.open("newhandDetial", "../newhandDetial/newhandDetial.html");
			} else if(FType == "2" || FType == "3" || FType == "0") { //随投定赎
				appcan.locStorage.setVal("dFMingC", FMingC);
				appcan.locStorage.setVal("FDqmid", Fid);
				appcan.locStorage.setVal("detailsFzero", Fzero);
				appcan.window.open("newhandDetialh", "../newhandDetialh/newhandDetialh.html");
			}

		}

		function headermoney(Fselect) {
			var parm = {
				Fuserid: Fsuper.getuserid()
			};
			var nurl = "";
			if(FTzselects == "ywc") {
				nurl = Serverurl + "/app/getYwcMoney";
				$(".tzbjtext").text("投资本金");
				$(".dslxtext").text("已赎本金");
				$(".yslxtext").text("已收利息");
			} else {
				if(Fselect == "stss") {
					nurl = Serverurl + "/app/getHuoQiSytotal";
					$(".tzbjtext").text("投资本金");
					$(".sybjtext").text("剩余本金");
					$(".dslxtext").text("今日利息");
					$(".yslxtext").text("已收利息");
				}
				if(Fselect == "stds") {
					nurl = Serverurl + "/app/getDqSytotal";
					$(".sybjtext").text("待收本金");
					$(".tzbjtext").text("投资本金");
					$(".dslxtext").text("待收利息");
					$(".yslxtext").text("已收利息");
				}
				if(Fselect == "lyg") {
					nurl = Serverurl + "/app/getLygtotal";
					$(".tzbjtext").text("投资本金");
					$(".sybjtext").text("剩余本金");
					$(".dslxtext").text("前置收益");
					$(".yslxtext").text("");
					$(".removeborder").removeClass("borderwhite");
				}

			}
			appcan.ajax({
				url: nurl,
				type: "POST",
				dataType: "json",
				data: parm,
				success: function(result) {
					var rows = result.data;
					var code = result.code;
					var msg = result.msg;
					var debug = result.debug;
					console.log(rows);
					console.log(parm);
					if(code < 10000) {
						if(code == 0) { //返回成功
							$(".tzbj").text(rows.tzbj);
							$(".dslx").text(rows.dslx);
							$(".yslx").text(rows.yslx);
							$(".sybj").text(rows.sybj);
							if(Fselect == "lyg") {
								$(".yslx").text("");
							}
						}
					} else {
						if(Fsuperdbg) {
							alert(result.code);
							alert(result.msg);
							alert(result.debug);
						}
					}
				}
			});
		}
	</script>

</html>